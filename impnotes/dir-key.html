<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>30.11. Extensions-2.11. Directory Access</title><link rel="stylesheet" href="impnotes.css" type="text/css"/><link rev="made" href="mailto:clisp-list@sf.net"/><meta name="generator" content="DocBook XSL Stylesheets V1.61.2"/><link rel="home" href="index.html" title="Implementation Notes for GNU CLISP."/><link rel="up" href="platform.html" title="Chapter 30. Extensions-2: Platform specific Extensions"/><link rel="previous" href="shell.html" title="30.10. Extensions-2.10. Shell, Pipes and Printing"/><link rel="next" href="getenv.html" title="30.12. Extensions-2.12. Operating System&#10;  Environment."/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">30.11. Extensions-2.11. Directory Access</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="shell.html">Prev</a> </td><th width="60%" align="center">Chapter 30. Extensions-2: Platform specific Extensions</th><td width="20%" align="right"> <a accesskey="n" href="getenv.html">Next</a></td></tr></table><hr/></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="dir-key"/>30.11. Extensions-2.11. Directory Access</h2></div></div><div/></div><p>When <a href="http://clisp.cons.org" target="_top"><b class="command">CLISP</b></a> is configured with an option
 <tt class="option">--with-dir-key</tt>, some directory access is available
g from lisp, in package <a href="dir-key.html" title="30.11. Extensions-2.11. Directory Access"><strong class="package">&#8220;<span class="quote">LDAP</span>&#8221;</strong></a>.  3 types of directory keys
 may exist, depending on the compilation environment.</p><div class="variablelist"><a id="dir-key-type"/><p class="title"><b>valid directory key types</b></p><dl><dt>:win32</dt><dd><a href="http://www.willows.com/" target="_top"><strong>Win32</strong></a> registry access
  </dd><dt>:gnome</dt><dd><a href="http://developer.gnome.org/doc/API/libgnome/gnome-gnome-config.html" target="_top">gnome-config</a> access
  </dd><dt>:ldap</dt><dd>LDAP interface via
   <a href="http://www.openldap.org" target="_top">OpenLDAP</a> or compatible
  </dd></dl></div><p>The following functions and macros are exported (please note that
these features are experimental and the API may be modified in the
future).</p><div class="variablelist"><dl><dt><a id="dir-key-open"/><tt class="sexp">(<a href="dir-key.html#dir-key-open"><tt class="function">LDAP:DIR-KEY-OPEN</tt></a>
   <i class="replaceable"><tt>dkey</tt></i> <i class="replaceable"><tt>pathname</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;KEY</tt></a> (<tt class="constant">:DIRECTION</tt> <tt class="constant">:INPUT</tt>)
   <tt class="constant">:IF-DOES-NOT-EXIST</tt>)</tt></dt><dd>Open the directory key under <i class="replaceable"><tt>dkey</tt></i>, which should
   be either an open directory key or a valid <a href="dir-key.html#dir-key-type">directory key type</a>.
   The meaning of the <tt class="constant">:DIRECTION</tt> and <tt class="constant">:IF-DOES-NOT-EXIST</tt> keyword
   arguments is the same as for <a href="http://www.lisp.org/HyperSpec/Body/fun_open.html" target="_top"><tt class="function">OPEN</tt></a>.</dd><dt><a id="dir-key-close"/><tt class="sexp">(<a href="dir-key.html#dir-key-close"><tt class="function">LDAP:DIR-KEY-CLOSE</tt></a> <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Close the directory key.  The preferred way is to
   use the <a href="dir-key.html#with-dir-key-open"><tt class="function">LDAP:WITH-DIR-KEY-OPEN</tt></a> macro.</dd><dt><a id="with-dir-key-open"/><tt class="sexp">(<a href="dir-key.html#with-dir-key-open"><tt class="function">LDAP:WITH-DIR-KEY-OPEN</tt></a> (<i class="replaceable"><tt>variable</tt></i> <i class="replaceable"><tt>dkey</tt></i> <i class="replaceable"><tt>pathname</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;REST</tt></a>
    {<i class="replaceable"><tt>option</tt></i>}*) <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-4.html" target="_top"><tt class="literal">&amp;BODY</tt></a> <i class="replaceable"><tt>body</tt></i>)</tt></dt><dd>Open the directory key (by calling <a href="dir-key.html#dir-key-open"><tt class="function">LDAP:DIR-KEY-OPEN</tt></a>
   on <i class="replaceable"><tt>dkey</tt></i>, <i class="replaceable"><tt>pathname</tt></i> and <i class="replaceable"><tt>option</tt></i>s), bind it to <i class="replaceable"><tt>variable</tt></i>,
   execute <i class="replaceable"><tt>body</tt></i>, then close it with <a href="dir-key.html#dir-key-close"><tt class="function">LDAP:DIR-KEY-CLOSE</tt></a>.
 </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-TYPE</tt> <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Return the <a href="dir-key.html#dir-key-type">directory key type</a> of the directory key
  </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-PATH</tt>
                <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Return the path of this directory key, which is the
   <i class="replaceable"><tt>pathname</tt></i> argument of <a href="dir-key.html#dir-key-open"><tt class="function">LDAP:DIR-KEY-OPEN</tt></a> if <i class="replaceable"><tt>dkey</tt></i> was a <a href="dir-key.html#dir-key-type">directory key type</a> or the
   concatenation of the <i class="replaceable"><tt>pathname</tt></i> argument and the
   <tt class="function">ldap:dir-key-path</tt> of <i class="replaceable"><tt>dkey</tt></i>.
   </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-DIRECTION</tt> <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>One of <tt class="constant">:INPUT</tt>, <tt class="constant">:OUTPUT</tt> and <tt class="constant">:IO</tt>, indicating
   the permitted operation on this key and its derivatives.
   </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-CLOSED-P</tt> <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Check whether the key has been closed.
   It is not an error to close a closed key.
   </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-SUBKEY-DELETE</tt>
     <i class="replaceable"><tt>dkey</tt></i> <i class="replaceable"><tt>subkey</tt></i>)</tt>
   <tt class="sexp">(<tt class="function">LDAP:DIR-KEY-VALUE-DELETE</tt>
     <i class="replaceable"><tt>dkey</tt></i> <i class="replaceable"><tt>attribute</tt></i>)</tt></dt><dd>Delete the specified subkey or attribute.
  </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-SUBKEY</tt> <i class="replaceable"><tt>dkey</tt></i>)</tt>
  <tt class="sexp">(<tt class="function">LDAP:DIR-KEY-ATTRIBUTES</tt>
                <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Return the list of the subkeys or attributes.
  </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-VALUE</tt> <i class="replaceable"><tt>dkey</tt></i>
    <i class="replaceable"><tt>attribute</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a>
    <i class="replaceable"><tt>default</tt></i>)</tt></dt><dd>Return the value of the specified attribute,
   similar to <a href="http://www.lisp.org/HyperSpec/Body/acc_gethash.html" target="_top"><tt class="function">GETHASH</tt></a> and <a href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><tt class="function">SETF</tt></a>able just like <a href="http://www.lisp.org/HyperSpec/Body/acc_gethash.html" target="_top"><tt class="function">GETHASH</tt></a>.
   </dd><dt><tt class="sexp">(<tt class="function">LDAP:DIR-KEY-INFO</tt> <i class="replaceable"><tt>dkey</tt></i>)</tt></dt><dd>Return some information about the directory key.
   This is highly platform-dependent and will probably be removed or
   replaced or modified in the future.</dd><dt><a id="with-dir-key-search"/><tt class="sexp">(<a href="dir-key.html#with-dir-key-search"><tt class="function">LDAP:WITH-DIR-KEY-SEARCH</tt></a> (<i class="replaceable"><tt>key-iter</tt></i>
                 <i class="replaceable"><tt>atribute-iter</tt></i>
                 <i class="replaceable"><tt>dkey</tt></i> <i class="replaceable"><tt>pathname</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;KEY</tt></a> <tt class="constant">:scope</tt>)
                 <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-4.html" target="_top"><tt class="literal">&amp;BODY</tt></a> <i class="replaceable"><tt>body</tt></i>)</tt></dt><dd><p>This is the main way to iterate over the subtree
   under the key <i class="replaceable"><tt>dkey</tt></i>+<i class="replaceable"><tt>pathname</tt></i>.</p><p><i class="replaceable"><tt>key-iter</tt></i> is a non-<a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> symbol
    and is bound via <a href="http://www.lisp.org/HyperSpec/Body/speope_fletcm_scm_macrolet.html" target="_top"><tt class="function">MACROLET</tt></a> to a macro, each call of which returns
    the next subkey.</p><p><i class="replaceable"><tt>atribute-iter</tt></i> is a symbol and is
    bound, when non-<a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a>, to a macro, each call of which returns two
   values - the next attribute and its value.</p><p>The <tt class="constant">:scope</tt> keyword argument specifies the
    scope of the search and can be
   </p><div class="variablelist"><dl><dt><tt class="constant">:self</tt></dt><dd>iterate over the key itself
     </dd><dt><tt class="constant">:level</tt></dt><dd>iterate over the children of the key
     </dd><dt><tt class="constant">:tree</tt></dt><dd>iterate over the subtree
     </dd></dl></div><p><a href="dir-key.html#with-dir-key-search"><tt class="function">LDAP:WITH-DIR-KEY-SEARCH</tt></a> is used to implement
    <tt class="function">LDAP:DIR-KEY-VALUES</tt>,
    <tt class="function">LDAP:DIR-KEY-CHILDREN</tt> and
    <tt class="function">LDAP:DIR-KEY-DUMP-TREE</tt> in
    <tt class="filename">dirkey.lisp</tt>.
    </p></dd></dl></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="shell.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="platform.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="getenv.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">30.10. Extensions-2.10. Shell, Pipes and Printing </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 30.12. Extensions-2.12. Operating System
  Environment.</td></tr></table></div><div class="custom-footer"><hr width="100%"/><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]"/></a></td><td align="center"><a href="http://www.gnu.org"><img src="http://www.gnu.org/graphics/gnubanner.jpg" width="468" height="60" alt="[Come and see what GNU creates for YOU]"/></a></td><td align="right"><a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=1355&amp;amp;type=2" width="125" height="37" alt="[SourceForge]"/></a></td></tr></table></div></body></html>
