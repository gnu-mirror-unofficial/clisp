<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>31.6. Quickstarting delivery with CLISP</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@sf.net" /><meta name="generator" content="DocBook XSL Stylesheets V1.68.1" /><link rel="start" href="index.html" title="Implementation Notes for GNU CLISP" /><link rel="up" href="ext-platform.html" title="Chapter 31. Platform Specific Extensions" /><link rel="prev" href="socket.html" title="31.5. Socket Streams" /><link rel="next" href="app-dev.html" title="31.7. Application delivery with CLISP" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.6. Quickstarting delivery with <span><strong class="command">CLISP</strong></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="socket.html">Prev</a> </td><th width="60%" align="center">Chapter 31. Platform Specific Extensions</th><td width="20%" align="right"> <a accesskey="n" href="app-dev.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="quickstart"></a>31.6. Quickstarting delivery with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="quickstart.html#quickstart-summary">31.6.1. Summary</a></span></dt><dt><span class="section"><a href="quickstart.html#quickstart-unix">31.6.2. Scripting with <span><strong class="command">CLISP</strong></span></a></span></dt><dt><span class="section"><a href="quickstart.html#quickstart-desktop">31.6.3. Desktop Environments</a></span></dt><dt><span class="section"><a href="quickstart.html#quickstart-linux">31.6.4. Associating extensions with <span><strong class="command">CLISP</strong></span> via kernel</a></span></dt></dl></div><p>This section describes three ways to turn <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> programs into
 executable programs, which can be started as quickly as executables
 written in other languages.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="quickstart-summary"></a>31.6.1. Summary</h3></div></div></div><div class="variablelist"><dl><dt><a href="http://www.UNIX-systems.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a></dt><dd><a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> can act as a script interpreter.
  </dd><dt>Desktop environments such as <a href="http://www.kde.org/" target="_top"><span class="strong"><strong>KDE</strong></span></a>, <a href="http://www.gnome.org/" target="_top"><span class="strong"><strong>Gnome</strong></span></a>,
   <a href="http://www.apple.com/macosx/" target="_top"><span class="strong"><strong>Mac OS X</strong></span></a> or <a href="http://winehq.com/" target="_top"><span class="strong"><strong>Win32</strong></span></a>.</dt><dd>Files created with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> can be associated with
   the <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> executable so that clicking on them would make <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>
   execute the appropriate code.</dd><dt><a href="http://www.linux.org/" target="_top"><span class="strong"><strong>Linux</strong></span></a> kernel with
   <code class="option">CONFIG_BINFMT_MISC=y</code></dt><dd>Associate the extensions <code class="filename">#P".fas"</code>
    and <code class="filename">#P".lisp"</code> with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>; then you can make the
    files executable and run them from the command line.
 </dd></dl></div><p>These three techniques apply to a single <code class="filename">#P".lisp"</code> or <code class="filename">#P".fas"</code> file.
 If your application is made up of several <code class="filename">#P".lisp"</code> or <code class="filename">#P".fas"</code> files,
 you can simply concatenate them (using <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/utilities/.html"><span><strong class="command">cat</strong></span></a>)
 into one file; the techniques then apply to that concatenated file.</p></div>
<!--#ifdef UNIX-->
<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="quickstart-unix"></a>31.6.2. Scripting with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a></h3></div><div><h4 class="subtitle"><span class="plat-dep">Platform Dependent: <span class="plat-dep"><a href="http://www.UNIX-systems.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a> platform only.</span></span></h4></div></div></div><p>On <a href="http://www.UNIX-systems.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a>, a text file (<code class="filename">#P".fas"</code> or <code class="filename">#P".lisp"</code>) can
 be made executable by adding a first line of the form
 </p><pre class="screen">#!<em class="replaceable"><code>interpreter</code></em> [<em class="replaceable"><code>interpreter-arguments</code></em>]</pre><p>
 and using <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/utilities/.html"><span><strong class="command">chmod</strong></span></a> to make the file
 executable.</p><p><b>OS Requirements. </b><a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> can be used as a script interpreter under the following
 conditions:
</p><div class="itemizedlist"><ul type="disc"><li>The <em class="replaceable"><code>interpreter</code></em> must be the full pathname of <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>.
 The recommended path is <code class="filename">/usr/local/bin/clisp</code>,
 and if <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> is actually installed elsewhere, making
 <code class="filename">/usr/local/bin/clisp</code> be a symbolic link to the
 real <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>.</li><li>The <em class="replaceable"><code>interpreter</code></em> must be a real executable, not a script.
 Unfortunately, in the binary distributions of <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> on Solaris,
 <span><strong class="command">clisp</strong></span> is a shell script because a <a href="http://www.eskimo.com/~scs/C-faq/top.html" target="_top"><span><strong class="command">C</strong></span></a> compiler cannot be
 assumed to be installed on this platform.  If you do have a <a href="http://www.eskimo.com/~scs/C-faq/top.html" target="_top"><span><strong class="command">C</strong></span></a>
 compiler installed, build <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> from the source yourself;
 <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/utilities/make.html"><span><strong class="command">make install</strong></span></a> will install <span><strong class="command">clisp</strong></span> as
 a real executable.</li><li><p>On some platforms, the first line which specifies the
 interpreter is limited in length:
   </p><div class="itemizedlist"><ul type="circle"><li>max. 32 characters on SunOS 4,</li><li>max. 80 characters on HP-UX,</li><li>max. 127 characters on <a href="http://www.linux.org/" target="_top"><span class="strong"><strong>Linux</strong></span></a>.</li></ul></div><p>
   Characters exceeding this limit are simply cut off by the system.
   At least 128 characters are accepted on Solaris, IRIX, AIX, OSF/1.
   There is no workaround: You have to keep the interpreter pathname
   and arguments short.</p></li><li>On Solaris and HP-UX, only the first
 <em class="replaceable"><code>interpreter-arg</code></em> is passed to the <em class="replaceable"><code>interpreter</code></em>.
 In order to pass more than one option (for example, <code class="option"><a href="clisp.html#opt-memfile" class="olink">-M</a></code> and
 <code class="option"><a href="clisp.html#opt-load-comp" class="olink">-C</a></code>) to <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>, separate them with
 <a href="http://www.fileformat.info/info/unicode/char/00a0/" target="_top">no-break
 spaces</a> instead of normal spaces.  (But the separator between
 <em class="replaceable"><code>interpreter</code></em> and <em class="replaceable"><code>interpreter-arguments</code></em> must still be a normal space!) <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>
 will split the <em class="replaceable"><code>interpreter-arguments</code></em> both at no-break spaces and at normal spaces.
</li></ul></div><p><a id="script-exec"></a><b>Script execution. </b></p><div class="itemizedlist"><ul type="disc"><li>The script should contain Lisp
   forms, except in the <code class="literal">#!</code> line.</li><li>The file is loaded normally, through the function
   <a href="http://www.lisp.org/HyperSpec/Body/fun_load.html" target="_top"><code class="function">LOAD</code></a> (in particular, the name of the script file, which
   is <code class="envar">$0</code> in <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/utilities/sh.html"><span><strong class="command">/bin/sh</strong></span></a>, can be found in <a href="http://www.lisp.org/HyperSpec/Body/var_stload-pa_d-truenamest.html" target="_top"><code class="varname">*LOAD-TRUENAME*</code></a> and
   <a href="http://www.lisp.org/HyperSpec/Body/var_stload-pa_d-truenamest.html" target="_top"><code class="varname">*LOAD-PATHNAME*</code></a>).</li><li>Before it is loaded, the variable <a href="quickstart.html#script-exec" class="olink"><code class="varname">EXT:*ARGS*</code></a> is bound
   to a <a href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a> of <a href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a>s, representing the arguments given to the
   Lisp script (i.e., <code class="envar">$1</code> in <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/utilities/sh.html"><span><strong class="command">/bin/sh</strong></span></a> becomes <code class="code">(<a href="http://www.lisp.org/HyperSpec/Body/acc_firstcm_s_inthcm_tenth.html" target="_top"><code class="function">FIRST</code></a>
     <a href="quickstart.html#script-exec" class="olink"><code class="varname">EXT:*ARGS*</code></a>)</code> etc).</li><li>The standard <a href="http://www.UNIX-systems.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a> i/o facilities
    (see <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/basedefs/stdio.h.html">&lt;<code class="filename">stdio.h</code>&gt;</a>) are used:
    <a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><code class="varname">*STANDARD-INPUT*</code></a> is bound to <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/functions/stdin.html"><code class="varname">stdin</code></a>,
    <a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><code class="varname">*STANDARD-OUTPUT*</code></a> to <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/functions/stdout.html"><code class="varname">stdout</code></a>, and
    <a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><code class="varname">*ERROR-OUTPUT*</code></a> to <a class="unix" href="http://www.opengroup.org/onlinepubs/007904975/functions/stderr.html"><code class="varname">stderr</code></a>.
  </li><li>The <a href="http://www.lisp.org/HyperSpec/Body/glo_c.html#continuable" target="_top">continuable</a> <a href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a>s will be turned into <a href="http://www.lisp.org/HyperSpec/Body/contyp_warning.html" target="_top"><code class="classname">WARNING</code></a>s
   (using <a href="conditions.html#appease-cerrors" class="olink"><code class="function">EXT:APPEASE-CERRORS</code></a>).</li><li>Non-<a href="http://www.lisp.org/HyperSpec/Body/glo_c.html#continuable" target="_top">continuable</a> <a href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a>s and
   <span><strong class="keycap">Control</strong></span>-<span class="keysym">C</span> interrupts will
   terminate the execution of the Lisp script with an error status
   (using <a href="conditions.html#exit-on-error" class="olink"><code class="function">EXT:EXIT-ON-ERROR</code></a>).</li><li>If you wish the script's contents to be compiled
    during loading, add <code class="option"><a href="clisp.html#opt-load-comp" class="olink">-C</a></code> to the <em class="replaceable"><code>interpreter-arguments</code></em>.
 </li></ul></div><p>
 See also <a href="clisp.html#opt-exec-file" class="olink">the manual</a>.
</p><p><a id="script-bad"></a><b>If nothing works. </b>Another, quite inferior, alternative is to put the following into
 a file:
</p><pre class="programlisting">
#!/bin/sh
exec clisp &lt;&lt;EOF
(lisp-form)
(another-lisp-form)
(yet-another-lisp-form)
EOF
</pre><p>
The problem with this approach is that the return values of each form
will be printed to the standard output.  Another problem is that no user
input will be available.</p></div>
<!--#endif-->
<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="quickstart-desktop"></a>31.6.3. Desktop Environments</h3></div><div><h4 class="subtitle"><span class="plat-dep">Platform Dependent: <span class="plat-dep"><a href="http://winehq.com/" target="_top"><span class="strong"><strong>Win32</strong></span></a>, <a href="http://www.gnome.org/" target="_top"><span class="strong"><strong>Gnome</strong></span></a>, <a href="http://www.kde.org/" target="_top"><span class="strong"><strong>KDE</strong></span></a>, <a href="http://www.apple.com/macosx/" target="_top"><span class="strong"><strong>Mac OS X</strong></span></a>
  desktop platforms only.</span></span></h4></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="quickstart-desktop-win32"></a>Notations</h3><p>Although we use <a href="http://winehq.com/" target="_top"><span class="strong"><strong>Win32</strong></span></a>-specific notation, these techniques work
 on other desktop environments as well.</p></div><p>There are two different ways to make <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>
 “<span class="quote">executables</span>” on desktop platforms.</p><div class="orderedlist"><ol type="1"><li>Associate the <code class="filename">#P".mem"</code> extension with
   <span><strong class="command">c:\clisp\clisp.exe <code class="option"><a href="clisp.html#opt-memfile" class="olink">-M</a></code> %s</strong></span>.
  </li><li>Associate the <code class="filename">#P".fas"</code> extension with
   <span><strong class="command">c:\clisp\clisp.exe <code class="option"><a href="clisp.html#opt-init" class="olink">-i</a></code> %s</strong></span>
    Alternatively, you may want to have a function
    <code class="function">main</code> in your <code class="filename">#P".fas"</code> files and associate
    the <code class="filename">#P".fas"</code> extension with <span><strong class="command">c:\clisp\clisp.exe <code class="option"><a href="clisp.html#opt-init" class="olink">-i</a></code>
     %s <code class="option"><a href="clisp.html#opt-exec-expr" class="olink">-x</a></code> (main)</strong></span>.
  </li></ol></div><p>Then clicking on the compiled lisp file (with <code class="filename">#P".fas"</code>
 extension) will load the file (thus executing all the code in the
 file), while the clicking on a <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> <a href="image.html" class="olink">memory image</a> (with <code class="filename">#P".mem"</code>
 extension) will start <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> with the given <a href="image.html" class="olink">memory image</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Note that <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> is distributed with a file
 <a class="clisp-cvs" href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/*checkout*/clisp/clisp/src/install.bat"><code class="filename">src/install.bat</code></a>, which creates a file
 <code class="filename">clisp.lnk</code> on your desktop and also associates
 <code class="filename">#P".fas"</code>, <code class="filename">#P".lisp"</code>, and <code class="filename">#P".mem"</code> files with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="quickstart-linux"></a>31.6.4. Associating extensions with <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> via kernel</h3></div><div><h4 class="subtitle"><span class="plat-dep">Platform Dependent: <span class="plat-dep"><a href="http://www.linux.org/" target="_top"><span class="strong"><strong>Linux</strong></span></a> platforms
   only.</span></span></h4></div></div></div><p>You have to build your kernel with
 <code class="option">CONFIG_BINFMT_MISC=y</code> and
 <code class="option">CONFIG_PROC_FS=y</code>.  Then you will have a
 <code class="filename">/proc/sys/fs/binfmt_misc/</code> directory and you will
 be able to do (as <code class="literal">root</code>; you might want to put
 these lines into <code class="filename">/etc/rc.d/rc.local</code>):

</p><pre class="screen">
<code class="prompt">#</code> echo ":CLISP:E::fas::/usr/local/bin/clisp:" &gt;&gt; /proc/sys/fs/binfmt_misc/register
<code class="prompt">#</code> echo ":CLISP:E::lisp::/usr/local/bin/clisp:" &gt;&gt; /proc/sys/fs/binfmt_misc/register
</pre><p>Then you can do the following:
</p><pre class="screen">
<code class="prompt">$</code> cat &lt;&lt; EOF &gt; hello.lisp
(print "hello, world!")
EOF
<code class="prompt">$</code> clisp -c hello.lisp
;; Compiling file hello.lisp ...
;; Wrote file hello.lisp
0 errors, 0 warnings
<code class="prompt">$</code> chmod +x hello.fas
<code class="prompt">$</code> hello.fas

"hello, world!"
<code class="prompt">$</code>
</pre><p>Please read
 <code class="filename">/usr/src/linux/Documentation/binfmt_misc.txt</code> for
 details.</p></div></div><div class="bookinfo"><hr width="100%" /><table width="100%" summary="impnotes meta info"><th><td align="left">These notes document <a href="http://clisp.cons.org" target="_top"><span><strong class="command">CLISP</strong></span></a> version 2.35</td><td align="right">Last modified: 2005-08-29</td></th></table></div><div class="custom-footer"><hr width="100%" /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://www.gnu.org"><img src="http://www.gnu.org/graphics/gnubanner.jpg" width="468" height="60" alt="[Come and see what GNU creates for YOU]" /></a></td><td align="right"><a href="http://sourceforge.net"><img width="125" height="37" alt="[SourceForge]" src="http://sflogo.sourceforge.net/sflogo.php?group_id=1355&amp;type=2&amp;page=quickstart" /></a></td></tr></table></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="socket.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ext-platform.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="app-dev.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">31.5. Socket Streams </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 31.7. Application delivery with <span><strong class="command">CLISP</strong></span></td></tr></table></div></body></html>
