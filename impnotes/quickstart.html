<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>30.6. Extensions-2.6. Quickstarting delivery with CLISP</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@sf.net" /><meta name="generator" content="DocBook XSL Stylesheets V1.65.1" /><link rel="home" href="index.html" title="Implementation Notes for GNU CLISP." /><link rel="up" href="platform.html" title="Chapter 30. Extensions-2: Platform specific Extensions" /><link rel="previous" href="socket.html" title="30.5. Extensions-2.5. Socket Streams" /><link rel="next" href="app-dev.html" title="30.7. Extensions-2.7. Application delivery with CLISP" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">30.6. Extensions-2.6. Quickstarting delivery with <span><b class="command">CLISP</b></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="socket.html">Prev</a> </td><th width="60%" align="center">Chapter 30. Extensions-2: Platform specific Extensions</th><td width="20%" align="right"> <a accesskey="n" href="app-dev.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="quickstart"></a>30.6. Extensions-2.6. Quickstarting delivery with <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a></h2></div></div><div></div></div><p>This section describes three ways to turn <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> programs into
 executable programs, which can be started as quickly as executables
 written in other languages.</p><div class="variablelist"><dl><dt><a href="http://www.UNIX-systems.org/online.html" target="_top"><strong>UNIX</strong></a></dt><dd><a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> can act as a script interpreter.
  </dd><dt>Desktop environments such as
   <a href="http://www.kde.org" target="_top">KDE</a>,
   <a href="http://www.gnome.org" target="_top">GNOME</a>, or Windows.</dt><dd>Files created with <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> can be associated with
   the <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> executable so that clicking on them would make <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>
   execute the appropriate code.</dd><dt><a href="http://www.linux.org/" target="_top"><strong>Linux</strong></a> kernel with
   <tt class="option">CONFIG_BINFMT_MISC=y</tt></dt><dd>Associate the extensions <tt class="filename">#P".fas"</tt>
    and <tt class="filename">#P".lisp"</tt> with <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>; then you can make the
    files executable and run them from the command line.
 </dd></dl></div><p>These three techniques apply to a single <tt class="filename">#P".lisp"</tt> or <tt class="filename">#P".fas"</tt> file.
 If your application is made up of several <tt class="filename">#P".lisp"</tt> or <tt class="filename">#P".fas"</tt> files,
 you can simply concatenate them (using <a href="http://www.opengroup.org/onlinepubs/007904975/utilities/cat.html" target="_top"><span><b class="command">cat</b></span></a>) into one file;
 the techniques then apply to that concatenated file.</p><div class="variablelist">
<!--#ifdef UNIX--><dl><dt><a id="quickstart-unix"></a>Platform dependent: <a href="http://www.UNIX-systems.org/online.html" target="_top"><strong>UNIX</strong></a> platforms only.</dt><dd><p>On Unix, a text file (<tt class="filename">#P".fas"</tt> or <tt class="filename">#P".lisp"</tt>) can be
 made executable by adding a first line of the form
 </p><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">#!<i class="replaceable"><tt>interpreter</tt></i> [<i class="replaceable"><tt>interpreter-arguments</tt></i>]</pre></td></tr></table><p>
 and using <a href="http://www.opengroup.org/onlinepubs/007904975/utilities/chmod.html" target="_top"><span><b class="command">chmod</b></span></a> to make the script executable.
 <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> can be used as a script interpreter under the following
 circumstances:</p><div class="itemizedlist"><ul type="disc"><li>The <i class="replaceable"><tt>interpreter</tt></i> must be the full pathname of <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>.
 The recommended path is <tt class="filename">/usr/local/bin/clisp</tt>,
 and if <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> is actually installed elsewhere, making
 <tt class="filename">/usr/local/bin/clisp</tt> be a symbolic link to the
 real <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>.</li><li>The <i class="replaceable"><tt>interpreter</tt></i> must be a real executable, not a script.
 Unfortunately, in the binary distributions of <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> on Solaris,
 <span><b class="command">clisp</b></span> is a shell script because a <a href="http://www.eskimo.com/~scs/C-faq/top.html" target="_top"><span><b class="command">C</b></span></a> compiler cannot be
 assumed to be installed on this platform.  If you do have a <a href="http://www.eskimo.com/~scs/C-faq/top.html" target="_top"><span><b class="command">C</b></span></a>
 compiler installed, build <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> from the source yourself;
 <span><b class="command">make install</b></span> will install <span><b class="command">clisp</b></span> as a real
 executable.</li><li><p>On some platforms, the first line which specifies the
 interpreter is limited in length:
   </p><div class="itemizedlist"><ul type="circle"><li>max. 32 characters on SunOS 4,</li><li>max. 80 characters on HP-UX,</li><li>max. 127 characters on <a href="http://www.linux.org/" target="_top"><strong>Linux</strong></a>.</li></ul></div><p>
   Characters exceeding this limit are simply cut off by the system.
   At least 128 characters are accepted on Solaris, IRIX, AIX, OSF/1.
   There is no workaround: You have to keep the interpreter pathname
   and arguments short.</p></li><li>On Solaris and HP-UX, only the first
 <i class="replaceable"><tt>interpreter-arg</tt></i> is passed to the
 <i class="replaceable"><tt>interpreter</tt></i>.  In order to pass more than one option (for example,
 <tt class="option">-Msomewhere.mem</tt> and <tt class="option">-C</tt>) to <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>,
 separate them by hard spaces (ISO Latin-1 character 160) instead of
 normal spaces.  (But the separator between <i class="replaceable"><tt>interpreter</tt></i> and <i class="replaceable"><tt>interpreter-arguments</tt></i>
 must still be a normal space!) <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> will split the <i class="replaceable"><tt>interpreter-arguments</tt></i> at
 hard spaces and at normal spaces.</li></ul></div><p><a id="script-exec"></a><b>Script execution. </b></p><div class="itemizedlist"><ul type="disc"><li>The script should contain Lisp
   forms, except in the <tt class="literal">#!</tt> line.</li><li>The file is loaded normally, through the function
   <a href="http://www.lisp.org/HyperSpec/Body/fun_load.html" target="_top"><tt class="function">LOAD</tt></a> (in particular, the name of the script file, which
   is <tt class="envar">$0</tt> in <a href="http://www.opengroup.org/onlinepubs/007904975/utilities/sh.html" target="_top"><span><b class="command">/bin/sh</b></span></a>, can be found in <a href="http://www.lisp.org/HyperSpec/Body/var_stload-pa_d-truenamest.html" target="_top"><tt class="varname">*LOAD-TRUENAME*</tt></a> and
   <a href="http://www.lisp.org/HyperSpec/Body/var_stload-pa_d-truenamest.html" target="_top"><tt class="varname">*LOAD-PATHNAME*</tt></a>).</li><li>Before it is loaded, the variable <a href="quickstart.html#script-exec"><tt class="varname">EXT:*ARGS*</tt></a> is bound
   to a list of strings, representing the arguments given to the Lisp
   script (i.e., <tt class="envar">$1</tt> in <a href="http://www.opengroup.org/onlinepubs/007904975/utilities/sh.html" target="_top"><span><b class="command">/bin/sh</b></span></a> becomes <tt class="sexp">(<a href="http://www.lisp.org/HyperSpec/Body/acc_carcm_cdr_darcm_cddddr.html" target="_top"><tt class="function">CAR</tt></a> <a href="quickstart.html#script-exec"><tt class="varname">EXT:*ARGS*</tt></a>)</tt> etc).</li><li><a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><tt class="varname">*STANDARD-INPUT*</tt></a> and <a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><tt class="varname">*STANDARD-OUTPUT*</tt></a> are
   bound, as usual, to the Unix standard input and output.
   <a href="http://www.lisp.org/HyperSpec/Body/var_stdebug-i_ace-outputst.html" target="_top"><tt class="varname">*ERROR-OUTPUT*</tt></a> is bound to the Unix error output.</li><li>Continuable errors will be turned to warnings
   (using <a href="conditions.html#appease-cerrors"><tt class="function">EXT:APPEASE-CERRORS</tt></a>).</li><li>Non-continuable errors and
   <span><b class="keycap">Control</b></span>-<span class="keysym">C</span> interrupts will
   terminate the execution of the Lisp script with an error status
   (using <a href="conditions.html#exit-on-error"><tt class="function">EXT:EXIT-ON-ERROR</tt></a>).</li><li>If you wish the script's contents to be compiled
  during loading, add
  <a href="clisp.html#opt-load-comp"><tt class="option">-C</tt></a>
  to the <i class="replaceable"><tt>interpreter-arguments</tt></i>.</li></ul></div><p>
 See also <a href="clisp.html#opt-exec-file">the manual</a>.
</p><p><a id="script-bad"></a><b>If nothing works. </b>Another, quite inferior, alternative is to put the following into
 a file:
</p><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="programlisting">
#!/bin/sh
exec clisp &lt;&lt;EOF
(lisp-form)
(another-lisp-form)
(yet-another-lisp-form)
EOF
</pre></td></tr></table><p>
The problem with this approach is that the return values of each form
will be printed to the standard output.  Another problem is that no user
input will be available.</p></dd>
<!--#endif-->
<!--#ifdef WIN32--><dt><a id="quickstart-win32"></a>Platform dependent: <a href="http://www.willows.com/" target="_top"><strong>Win32</strong></a> platforms only.</dt><dd><p>There are two different ways to make <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>
 "executables" for Windows platforms.</p><div class="itemizedlist"><ul type="disc"><li>Associate the <tt class="filename">#P".mem"</tt> extension with
   <span><b class="command">c:\clisp\lisp.exe -B c:\clisp -M %s</b></span>.
  </li><li>Associate the <tt class="filename">#P".fas"</tt> extension with
   <span><b class="command">c:\clisp\lisp.exe -B c:\clisp -M c:\clisp\lispinit.mem
    -i %s</b></span>.
    Alternatively, you may want to have a function
    <tt class="function">main</tt> in your <tt class="filename">#P".fas"</tt> files and associate
    the <tt class="filename">#P".fas"</tt> extension with <span><b class="command">c:\clisp\lisp.exe -B
    c:\clisp -M c:\clisp\lispinit.mem -i %s -x (main)</b></span>.
  </li></ul></div><p>Then clicking on the compiled lisp file (with <tt class="filename">#P".fas"</tt>
 extension) will load the file (thus executing all the code in the
 file), while the clicking on a <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> <a href="image.html" title="29.1. Extensions-1.1. Saving an Image">memory image</a> (with <tt class="filename">#P".mem"</tt>
 extension) will start clisp with the given <a href="image.html" title="29.1. Extensions-1.1. Saving an Image">memory image</a>.</p><p>Note that <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> is distributed with a file
 <tt class="filename">install.bat</tt>, which creates a file
 <tt class="filename">clisp.lnk</tt> on your desktop and also associates
 <tt class="filename">#P".fas"</tt>, <tt class="filename">#P".lisp"</tt>, and <tt class="filename">#P".mem"</tt> files with <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a>.</p></dd>
<!--#endif-->
<dt><a id="quickstart-linux"></a>Platform dependent: <a href="http://www.linux.org/" target="_top"><strong>Linux</strong></a> platforms only.</dt><dd><p>You have to build your kernel with
 <tt class="option">CONFIG_BINFMT_MISC=y</tt> and
 <tt class="option">CONFIG_PROC_FS=y</tt>.  Then you will have a
 <tt class="filename">/proc/sys/fs/binfmt_misc/</tt> directory and you will
 be able to do (as <tt class="literal">root</tt>; you might want to put
 these lines into <tt class="filename">/etc/rc.d/rc.local</tt>):

</p><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="screen">
bash# echo ":CLISP:E::fas::/usr/local/bin/clisp:" &gt;&gt; /proc/sys/fs/binfmt_misc/register
bash# echo ":CLISP:E::lisp::/usr/local/bin/clisp:" &gt;&gt; /proc/sys/fs/binfmt_misc/register
</pre></td></tr></table><p>Then you can do the following:
</p><table border="0" bgcolor="#E0E0E0"><tr><td><pre class="screen">
bash$ cat &lt;&lt; EOF &gt; hello.lisp
(print "hello, world!")
EOF
bash$ clisp -c hello.lisp

Compiling file hello.lisp ...

Compilation of file hello.lisp is finished.
0 errors, 0 warnings
bash$ chmod +x hello.fas
bash$ hello.fas

"hello, world!"
bash$
</pre></td></tr></table><p>Please read
 <tt class="filename">/usr/src/linux/Documentation/binfmt_misc.txt</tt> for
 details.</p></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="socket.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="platform.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="app-dev.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">30.5. Extensions-2.5. Socket Streams </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 30.7. Extensions-2.7. Application delivery with <span><b class="command">CLISP</b></span></td></tr></table></div><div class="custom-footer"><hr width="100%" /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://www.gnu.org"><img src="http://www.gnu.org/graphics/gnubanner.jpg" width="468" height="60" alt="[Come and see what GNU creates for YOU]" /></a></td><td align="right"><a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=1355&amp;amp;type=2" width="125" height="37" alt="[SourceForge]" /></a></td></tr></table></div></body></html>
