<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>Extensions-2.6. Socket Streams</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REV="MADE"
HREF="mailto:clisp-list@sf.net"><LINK
REL="HOME"
TITLE="Implementation Notes for GNU CLISP."
HREF="impnotes-top.html"><LINK
REL="UP"
TITLE="Extensions-2: Platform specific Extensions"
HREF="platform.html"><LINK
REL="PREVIOUS"
TITLE="Extensions-2.5. ARexx"
HREF="rexx.html"><LINK
REL="NEXT"
TITLE="Extensions-2.7. Quickstarting delivery with CLISP"
HREF="quickstart.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="impnotes.css"></HEAD
><BODY
CLASS="section"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Implementation Notes for <A
HREF="http://www.gnu.org"
TARGET="_top"
>GNU</A
> <A
HREF="http://clisp.cons.org"
TARGET="_top"
><B
CLASS="command"
>CLISP</B
></A
>.: These notes document <A
HREF="http://clisp.cons.org"
TARGET="_top"
><B
CLASS="command"
>CLISP</B
></A
> version 2.31.</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="rexx.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 30. Extensions-2: Platform specific Extensions</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="quickstart.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="section"
><H1
CLASS="section"
><A
NAME="socket"
></A
>30.6. Extensions-2.6. Socket Streams</H1
><FONT
COLOR="RED"
>Platform dependent: <A
HREF="http://www.UNIX-systems.org/online.html"
TARGET="_top"
><B
CLASS="emphasis"
>UNIX</B
></A
>, <A
HREF="http://www.willows.com/"
TARGET="_top"
><B
CLASS="emphasis"
>Win32</B
></A
> platforms only.</FONT
><P
></P
><DIV
CLASS="variablelist"
><DL
><DT
><A
NAME="sose"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sose"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVER</TT
></A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;OPTIONAL</TT
></A
>
                 [<TT
CLASS="replaceable"
><I
>port-or-socket</I
></TT
>])</TT
></DT
><DD
><P
ALIGN="justify"
>This function creates a socket an binds a port to
    the socket.  The server exists to watch for client connect attempts.
    The optional argument is either a port (positive <A
HREF="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html"
TARGET="_top"
><TT
CLASS="classname"
>FIXNUM</TT
></A
>) or a
    <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
> (from whose peer the connections will be made).
 </P
></DD
><DT
><A
NAME="sose-close"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sose-close"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVER-CLOSE</TT
></A
>
                 <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Closes down the server socket.
    <A
HREF="stream-dict.html#close"
>Just like streams</A
>,
    <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
>s are closed at <A
HREF="gc.html"
>garbage-collect</A
>ion.  You should not rely on
    this however, because <A
HREF="gc.html"
>garbage-collect</A
>ion times are not deterministic.
 </P
></DD
><DT
><A
NAME="sose-hopo"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sose-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVER-HOST</TT
></A
> <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
>)</TT
><BR><TT
CLASS="sexp"
>(<A
HREF="socket.html#sose-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVER-PORT</TT
></A
> <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Returns the host mask indicating which hosts can
    connect to this server and the port which was bound using <A
HREF="socket.html#sose"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVER</TT
></A
>.
 </P
></DD
><DT
><A
NAME="so-wait"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#so-wait"
><TT
CLASS="function"
>SOCKET:SOCKET-WAIT</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
> <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;OPTIONAL</TT
></A
> <A
HREF="socket.html#timeout-opt"
>[<TT
CLASS="replaceable"
><I
>seconds</I
></TT
> [<TT
CLASS="replaceable"
><I
>microseconds</I
></TT
>]]</A
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Wait for a fixed time for a
    connection on the <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
> (a <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
>).
    Without a timeout argument, <A
HREF="socket.html#so-wait"
><TT
CLASS="function"
>SOCKET:SOCKET-WAIT</TT
></A
> blocks indefinitely.
    When timeout is zero, poll.
    Returns <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_t.html"
TARGET="_top"
><TT
CLASS="constant"
>T</TT
></A
> when a connection is available (i.e., <A
HREF="socket.html#so-accept"
><TT
CLASS="function"
>SOCKET:SOCKET-ACCEPT</TT
></A
> will
    not block) and <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> on timeout.</P
></DD
><DT
><A
NAME="so-accept"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#so-accept"
><TT
CLASS="function"
>SOCKET:SOCKET-ACCEPT</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
> <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;KEY</TT
></A
> <A
HREF="stream-dict.html#eltype"
><TT
CLASS="constant"
>:ELEMENT-TYPE</TT
></A
> <A
HREF="stream-dict.html#extfmt"
><TT
CLASS="constant"
>:EXTERNAL-FORMAT</TT
></A
> <A
HREF="stream-dict.html#buffered"
><TT
CLASS="constant"
>:BUFFERED</TT
></A
>
    <A
HREF="socket.html#timeout-k"
><TT
CLASS="constant"
>:TIMEOUT</TT
></A
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Creates the server-side two-way
   stream for the connection.
   Waits for an attempt to connect to the server for no more than
   <A
HREF="socket.html#timeout-k"
><TT
CLASS="constant"
>:TIMEOUT</TT
></A
> seconds (which may be a non-negative real number or a
   list <TT
CLASS="sexp"
>(sec usec)</TT
> or a pair
   <TT
CLASS="sexp"
>(sec . usec)</TT
>).
   <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_signal.html"
TARGET="_top"
><TT
CLASS="function"
>SIGNAL</TT
></A
>s an <A
HREF="http://www.lisp.org/HyperSpec/Body/contyp_error.html"
TARGET="_top"
><TT
CLASS="classname"
>ERROR</TT
></A
> if no connection is made in that time.
  </P
></DD
><DT
><A
NAME="so-connect"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#so-connect"
><TT
CLASS="function"
>SOCKET:SOCKET-CONNECT</TT
></A
>
    <TT
CLASS="replaceable"
><I
>port</I
></TT
> <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;OPTIONAL</TT
></A
> [<TT
CLASS="replaceable"
><I
>host</I
></TT
>] <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;KEY</TT
></A
>
    <A
HREF="stream-dict.html#eltype"
><TT
CLASS="constant"
>:ELEMENT-TYPE</TT
></A
> <A
HREF="stream-dict.html#extfmt"
><TT
CLASS="constant"
>:EXTERNAL-FORMAT</TT
></A
> <A
HREF="stream-dict.html#buffered"
><TT
CLASS="constant"
>:BUFFERED</TT
></A
> <A
HREF="socket.html#timeout-k"
><TT
CLASS="constant"
>:TIMEOUT</TT
></A
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Attempts to create a client-side two-way
   <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>.  Blocks until the server accepts the connection, for
   no more than <A
HREF="socket.html#timeout-k"
><TT
CLASS="constant"
>:TIMEOUT</TT
></A
> seconds.  If it is 0, returns immediately
   and (probably) blocks on the next i/o operation (you can use
   <A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
> to check whether it will actually block).
  </P
></DD
><DT
><A
NAME="so-status"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
>
                 <TT
CLASS="replaceable"
><I
>socket-stream-or-list</I
></TT
>
                 <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;OPTIONAL</TT
></A
> <A
HREF="socket.html#timeout-opt"
>[<TT
CLASS="replaceable"
><I
>seconds</I
></TT
> [<TT
CLASS="replaceable"
><I
>microseconds</I
></TT
>]]</A
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Checks whether it is possible to read from or write
   to a <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
> or whether a connection is available on a
   <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
> without blocking.</P
><P
ALIGN="justify"
>For the cognoscenti: this is the interface to <A
HREF="http://www.opengroup.org/onlinepubs/007904975/functions/select.html"
TARGET="_top"
><TT
CLASS="function"
>select</TT
></A
>, so
   it will work for any <A
HREF="http://clisp.cons.org"
TARGET="_top"
><B
CLASS="command"
>CLISP</B
></A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> which is based on a
   <A
HREF="http://www.opengroup.org/onlinepubs/007904975/basedefs/xbd_chap03.html#tag_03_165"
TARGET="_top"
>file descriptor</A
>, e.g., <A
HREF="stream-dict.html#open"
>file</A
>/<A
HREF="shell.html#pipe"
>pipe</A
>/<A
HREF="socket.html"
>socket</A
> and <A
HREF="terminal.html"
><TT
CLASS="varname"
>EXT:*KEYBOARD-INPUT*</TT
></A
>.</P
><P
ALIGN="justify"
>This is similar to
    <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_listen.html"
TARGET="_top"
><TT
CLASS="function"
>LISTEN</TT
></A
>, which checks only one <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> and only for input, and
    <A
HREF="socket.html#so-wait"
><TT
CLASS="function"
>SOCKET:SOCKET-WAIT</TT
></A
>, which works only with <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
>s.</P
><P
ALIGN="justify"
>We define <SPAN
CLASS="QUOTE"
>"status"</SPAN
> for a <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
> or a
    <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
> to be <TT
CLASS="constant"
>:ERROR</TT
> if any i/o operation will cause an
    error.</P
><P
ALIGN="justify"
>Additionally, for a <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
>, we define
    <SPAN
CLASS="QUOTE"
>"status"</SPAN
> to be <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_t.html"
TARGET="_top"
><TT
CLASS="constant"
>T</TT
></A
> if a connection is available, i.e.,
    is <A
HREF="socket.html#so-accept"
><TT
CLASS="function"
>SOCKET:SOCKET-ACCEPT</TT
></A
> will not block, and <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> otherwise.</P
><P
ALIGN="justify"
>Additionally, for a <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>, we define
    <SPAN
CLASS="QUOTE"
>"status"</SPAN
> in the given <TT
CLASS="replaceable"
><I
>direction</I
></TT
> (one of <TT
CLASS="constant"
>:INPUT</TT
>,
    <TT
CLASS="constant"
>:OUTPUT</TT
>, and <TT
CLASS="constant"
>:IO</TT
>) to be
    <P
></P
><DIV
CLASS="variablelist"
><P
><B
>Possible status values for various directions:</B
></P
><DL
><DT
><TT
CLASS="constant"
>:INPUT</TT
> status:</DT
><DD
><P
></P
><DIV
CLASS="variablelist"
><DL
><DT
><A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
></DT
><DD
><P
ALIGN="justify"
>reading will block
        </P
></DD
><DT
><TT
CLASS="constant"
>:INPUT</TT
></DT
><DD
><P
ALIGN="justify"
>some input is available
        </P
></DD
><DT
><TT
CLASS="constant"
>:EOF</TT
></DT
><DD
><P
ALIGN="justify"
>the stream has reached its end
       </P
></DD
></DL
></DIV
></DD
><DT
><TT
CLASS="constant"
>:OUTPUT</TT
> status:</DT
><DD
><P
></P
><DIV
CLASS="variablelist"
><DL
><DT
><A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
></DT
><DD
><P
ALIGN="justify"
>writing will block
        </P
></DD
><DT
><TT
CLASS="constant"
>:OUTPUT</TT
></DT
><DD
><P
ALIGN="justify"
>output to the stream will not block
       </P
></DD
></DL
></DIV
></DD
><DT
><TT
CLASS="constant"
>:IO</TT
> status:</DT
><DD
><DIV
CLASS="informaltable"
><A
NAME="so-status-i-o"
></A
><P
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><THEAD
><TR
><TH
ROWSPAN="2"
WIDTH="25%"
ALIGN="CENTER"
VALIGN="BOTTOM"
>output status</TH
><TH
COLSPAN="3"
ALIGN="CENTER"
VALIGN="MIDDLE"
>input status</TH
></TR
><TR
><TH
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
></TH
><TH
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:INPUT</TT
></TH
><TH
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:EOF</TT
></TH
></TR
></THEAD
><TBODY
><TR
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:INPUT</TT
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:EOF</TT
></TD
></TR
><TR
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:OUTPUT</TT
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:OUTPUT</TT
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:IO</TT
></TD
><TD
WIDTH="25%"
ALIGN="CENTER"
VALIGN="MIDDLE"
><TT
CLASS="constant"
>:APPEND</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
></DD
></DL
></DIV
></P
><P
></P
><DIV
CLASS="variablelist"
><P
><B
>Possible values of
     <TT
CLASS="replaceable"
><I
>socket-stream-or-list</I
></TT
>:</B
></P
><DL
><DT
><A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
> or <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-SERVER</TT
></A
></DT
><DD
><P
ALIGN="justify"
>Returns the appropriate status, as defined
       above (<TT
CLASS="constant"
>:IO</TT
> status for <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>)
    </P
></DD
><DT
><TT
CLASS="sexp"
>(<A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>
       . <TT
CLASS="replaceable"
><I
>direction</I
></TT
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Return the status in the specified direction
    </P
></DD
><DT
>a list of the above</DT
><DD
><P
ALIGN="justify"
>Return a list of values, one for each element of the
       argument list (a la <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_mapccm_ma_istcm_mapcon.html"
TARGET="_top"
><TT
CLASS="function"
>MAPCAR</TT
></A
>)</P
></DD
></DL
></DIV
><P
ALIGN="justify"
>If you want to avoid <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_cons.html"
TARGET="_top"
><TT
CLASS="function"
>CONS</TT
></A
>ing up a <A
HREF="http://www.lisp.org/HyperSpec/Body/glo_f.html#fresh"
TARGET="_top"
>fresh</A
> list, you can
    make the elements of <TT
CLASS="replaceable"
><I
>socket-stream-or-list</I
></TT
>
    to be <TT
CLASS="sexp"
>(<TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
> <TT
CLASS="replaceable"
><I
>direction</I
></TT
> .
     <TT
CLASS="replaceable"
><I
>x</I
></TT
>)</TT
> or <TT
CLASS="sexp"
>(<TT
CLASS="replaceable"
><I
>socket-server</I
></TT
> . <TT
CLASS="replaceable"
><I
>x</I
></TT
>)</TT
>.
    Then <A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
> will destructively modify its argument and replace
    <TT
CLASS="replaceable"
><I
>x</I
></TT
> or <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> with the status and return the modified list.
    You can pass this modified list to <A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
> again.</P
><P
ALIGN="justify"
>The optional arguments specify the timeout. <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> means
    wait forever, <TT
CLASS="literal"
>0</TT
> means poll.</P
><P
ALIGN="justify"
>The second value returned is the number of objects with
    non-<A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> status, i.e., <SPAN
CLASS="QUOTE"
>"actionable"</SPAN
> objects.
    <A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
> returns either due to a timeout or when this number is
    positive, i.e., if the timeout was <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
> and <A
HREF="socket.html#so-status"
><TT
CLASS="function"
>SOCKET:SOCKET-STATUS</TT
></A
> did
    return, then the second value is positive.</P
></DD
><DT
><A
NAME="sost-hopo"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sost-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-HOST</TT
></A
> <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
>)</TT
><BR><TT
CLASS="sexp"
>(<A
HREF="socket.html#sost-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-PORT</TT
></A
> <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
>)</TT
></DT
><DD
><P
ALIGN="justify"
>These two functions return information about the
    <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>.</P
></DD
><DT
><A
NAME="service-port"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#service-port"
><TT
CLASS="function"
>SOCKET:SOCKET-SERVICE-PORT</TT
></A
>
                 <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;OPTIONAL</TT
></A
> <TT
CLASS="replaceable"
><I
>service-name</I
></TT
>
                 (<TT
CLASS="replaceable"
><I
>protocol</I
></TT
> "tcp"))</TT
></DT
><DD
><P
ALIGN="justify"
>A convenience function for looking up a port given
   the service name.  It returns the servent struct as multiple values
   (name, list of aliases, port, protocol) for the given
   <TT
CLASS="replaceable"
><I
>service-name</I
></TT
> and
   <TT
CLASS="replaceable"
><I
>protocol</I
></TT
>, or all services as the list of
   <TT
CLASS="type"
>(<A
HREF="http://www.lisp.org/HyperSpec/Body/typ_simple-vector.html"
TARGET="_top"
><TT
CLASS="classname"
>SIMPLE-VECTOR</TT
></A
> 4)</TT
>
   if <TT
CLASS="replaceable"
><I
>service-name</I
></TT
> is not given or is
   <TT
CLASS="constant"
>:DEFAULT</TT
> or <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
>.</P
></DD
><DT
><A
NAME="sost-peer"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sost-peer"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-PEER</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
> [<TT
CLASS="replaceable"
><I
>do-not-resolve-p</I
></TT
>])</TT
></DT
><DD
><P
ALIGN="justify"
>Given a socket stream, this function returns the
   name of the host on the opposite side of the connection and its port
   number; the server-side can use this to see who connected.</P
><P
ALIGN="justify"
>When the optional second argument is non-<A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
>, the hostname
   resolution is disabled and just the IP address is returned, without
   the <SPAN
CLASS="acronym"
>FQDN</SPAN
> (Fully Qualified Domain Name).
   </P
></DD
><DT
><A
NAME="sost-local"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sost-local"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-LOCAL</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
> [<TT
CLASS="replaceable"
><I
>do-not-resolve-p</I
></TT
>])</TT
></DT
><DD
><P
ALIGN="justify"
>The dual to <A
HREF="socket.html#sost-peer"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-PEER</TT
></A
> - same information,
   host name and port number, but for the local host.
   The difference from <A
HREF="socket.html#sost-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-HOST</TT
></A
> and <A
HREF="socket.html#sost-hopo"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-PORT</TT
></A
> is that this function
   asks the OS (and thus returns the correct trusted values) while the
   other two are just accessors to the internal data structure, and
   basically return the arguments given to the function which created
   the <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
>.</P
></DD
><DT
><A
NAME="sost-shut"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#sost-shut"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-SHUTDOWN</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
> <TT
CLASS="replaceable"
><I
>direction</I
></TT
>)</TT
></DT
><DD
><P
ALIGN="justify"
>Some Internet protocols, such as <A
HREF="http://www.w3.org/Protocols/"
TARGET="_top"
><B
CLASS="command"
>HTTP</B
></A
>, provide for
   closing the connection in one <TT
CLASS="replaceable"
><I
>direction</I
></TT
> using <A
HREF="http://www.opengroup.org/onlinepubs/007904975/functions/shutdown.html"
TARGET="_top"
><TT
CLASS="function"
>shutdown</TT
></A
>.
   This function provides an interface to this <A
HREF="http://www.UNIX-systems.org/online.html"
TARGET="_top"
><B
CLASS="emphasis"
>UNIX</B
></A
> system call.
   <TT
CLASS="replaceable"
><I
>direction</I
></TT
> should be <TT
CLASS="constant"
>:INPUT</TT
> or <TT
CLASS="constant"
>:OUTPUT</TT
>.
   Note that you should still call <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_close.html"
TARGET="_top"
><TT
CLASS="function"
>CLOSE</TT
></A
> after you are done with your
   <TT
CLASS="replaceable"
><I
>socket-stream</I
></TT
>; this is best accomplished by using <A
HREF="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html"
TARGET="_top"
><TT
CLASS="function"
>WITH-OPEN-STREAM</TT
></A
>.</P
><P
ALIGN="justify"
>All <A
HREF="socket.html"
><TT
CLASS="classname"
>SOCKET:SOCKET-STREAM</TT
></A
>s are <A
HREF="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional"
TARGET="_top"
>bidirectional</A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
>s (i.e., both <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html"
TARGET="_top"
><TT
CLASS="function"
>INPUT-STREAM-P</TT
></A
>
   and <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html"
TARGET="_top"
><TT
CLASS="function"
>OUTPUT-STREAM-P</TT
></A
> return <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_t.html"
TARGET="_top"
><TT
CLASS="constant"
>T</TT
></A
> for them).
   <A
HREF="socket.html#sost-shut"
><TT
CLASS="function"
>SOCKET:SOCKET-STREAM-SHUTDOWN</TT
></A
> <I
CLASS="emphasis"
>breaks</I
> this and turns its argument
   stream into an <A
HREF="http://www.lisp.org/HyperSpec/Body/glo_i.html#input"
TARGET="_top"
>input</A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> (if <TT
CLASS="replaceable"
><I
>direction</I
></TT
> is <TT
CLASS="constant"
>:OUTPUT</TT
>) or <A
HREF="http://www.lisp.org/HyperSpec/Body/glo_o.html#output"
TARGET="_top"
>output</A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> (if
   <TT
CLASS="replaceable"
><I
>direction</I
></TT
> is <TT
CLASS="constant"
>:INPUT</TT
>).
    Thus, the following important invariant is preserved: whenever
   <P
></P
><UL
><LI
><P
ALIGN="justify"
>a <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> is open
    (i.e., <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_open-stream-p.html"
TARGET="_top"
><TT
CLASS="function"
>OPEN-STREAM-P</TT
></A
> returns <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_t.html"
TARGET="_top"
><TT
CLASS="constant"
>T</TT
></A
>) and</P
></LI
><LI
><P
ALIGN="justify"
>a <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> is an <A
HREF="http://www.lisp.org/HyperSpec/Body/glo_i.html#input"
TARGET="_top"
>input</A
> <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> (i.e., <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html"
TARGET="_top"
><TT
CLASS="function"
>INPUT-STREAM-P</TT
></A
>
     returns <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_t.html"
TARGET="_top"
><TT
CLASS="constant"
>T</TT
></A
>)</P
></LI
></UL
>
   the <A
HREF="http://www.lisp.org/HyperSpec/Body/syscla_stream.html"
TARGET="_top"
><TT
CLASS="classname"
>STREAM</TT
></A
> can be read from (e.g., with <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_read-char.html"
TARGET="_top"
><TT
CLASS="function"
>READ-CHAR</TT
></A
> or <A
HREF="http://www.lisp.org/HyperSpec/Body/fun_read-byte.html"
TARGET="_top"
><TT
CLASS="function"
>READ-BYTE</TT
></A
>).
 </P
></DD
><DT
><A
NAME="so-opt"
></A
><TT
CLASS="sexp"
>(<A
HREF="socket.html#so-opt"
><TT
CLASS="function"
>SOCKET:SOCKET-OPTIONS</TT
></A
>
    <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
> <A
HREF="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html"
TARGET="_top"
><TT
CLASS="literal"
>&#38;REST</TT
></A
> {<TT
CLASS="replaceable"
><I
>option</I
></TT
>}*)</TT
></DT
><DD
><P
ALIGN="justify"
>Query and, optionally, set socket options using
   <A
HREF="http://www.opengroup.org/onlinepubs/007904975/functions/getsockopt.html"
TARGET="_top"
><TT
CLASS="function"
>getsockopt</TT
></A
> and <A
HREF="http://www.opengroup.org/onlinepubs/007904975/functions/setsockopt.html"
TARGET="_top"
><TT
CLASS="function"
>setsockopt</TT
></A
>.
   An <TT
CLASS="replaceable"
><I
>option</I
></TT
> is a keyword, optionally followed by the new value.
   When the new value is not supplied, <A
HREF="http://www.opengroup.org/onlinepubs/007904975/functions/setsockopt.html"
TARGET="_top"
><TT
CLASS="function"
>setsockopt</TT
></A
> is not called.
   For each option the old (or current, if new value was not supplied)
   value is returned. E.g., <TT
CLASS="sexp"
>(<A
HREF="socket.html#so-opt"
><TT
CLASS="function"
>SOCKET:SOCKET-OPTIONS</TT
></A
> <TT
CLASS="replaceable"
><I
>socket-server</I
></TT
>
   :SO-LINGER 1 :SO-RCVLOWAT)</TT
> returns 2 values: <A
HREF="http://www.lisp.org/HyperSpec/Body/convar_nil.html"
TARGET="_top"
><TT
CLASS="constant"
>NIL</TT
></A
>, the old
   value of the <TT
CLASS="constant"
>:SO-LINGER</TT
> option, and 1, the
   current value of the <TT
CLASS="constant"
>:SO-RCVLOWAT</TT
> option.
  </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="rexx.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="impnotes-top.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="quickstart.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Extensions-2.5. ARexx</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="platform.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Extensions-2.7. Quickstarting delivery with <A
HREF="http://clisp.cons.org"
TARGET="_top"
><B
CLASS="command"
>CLISP</B
></A
></TD
></TR
></TABLE
></DIV
><div
class="custom-footer"
><hr
width="100%"><table
width="100%"
><tr
><td
align="left"
><a
href="http://clisp.cons.org"
><img
src="clisp.png"
width="48"
height="48"
alt="[CLISP home]"></a
></td
><td
align="center"
><a
href="http://www.gnu.org"
><img
src="http://www.gnu.org/graphics/gnubanner.jpg"
width="468"
height="60"
alt="[Come and see what GNU creates for YOU]"></a
></td
><td
align="right"
><a
href="http://sourceforge.net"
><img
src="http://sourceforge.net/sflogo.php?group_id=1355&amp;type=2"
width="125"
height="37"
alt="[SourceForge]"></a
></td
></tr
></table
></div
></BODY
></HTML
>