<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>30.5. Extensions-2.5. Socket Streams</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@sf.net" /><meta name="generator" content="DocBook XSL Stylesheets V1.65.1" /><link rel="home" href="index.html" title="Implementation Notes for GNU CLISP." /><link rel="up" href="platform.html" title="Chapter 30. Extensions-2: Platform specific Extensions" /><link rel="previous" href="affi.html" title="30.4. Extensions-2.4. The Amiga Foreign Function Call Facility" /><link rel="next" href="quickstart.html" title="30.6. Extensions-2.6. Quickstarting delivery with CLISP" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">30.5. Extensions-2.5. Socket Streams</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="affi.html">Prev</a> </td><th width="60%" align="center">Chapter 30. Extensions-2: Platform specific Extensions</th><td width="20%" align="right"> <a accesskey="n" href="quickstart.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="socket"></a>30.5. Extensions-2.5. Socket Streams</h2></div><div><h3 class="subtitle">Platform dependent: <a href="http://www.UNIX-systems.org/online.html" target="_top"><strong>UNIX</strong></a>, <a href="http://www.willows.com/" target="_top"><strong>Win32</strong></a> platforms only.</h3></div></div><div></div></div>
<!--#ifdef SOCKET_STREAMS--><div class="variablelist"><dl><dt><a id="sose"></a><tt class="sexp">(<a href="socket.html#sose"><tt class="function">SOCKET:SOCKET-SERVER</tt></a> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a>
                 [<i class="replaceable"><tt>port-or-socket</tt></i>])</tt></dt><dd>This function creates a socket an binds a port to
    the socket.  The server exists to watch for client connect attempts.
    The optional argument is either a port (positive <a href="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html" target="_top"><tt class="classname">FIXNUM</tt></a>) or a
    <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a> (from whose peer the connections will be made).
 </dd><dt><a id="sose-close"></a><tt class="sexp">(<a href="socket.html#sose-close"><tt class="function">SOCKET:SOCKET-SERVER-CLOSE</tt></a>
                 <i class="replaceable"><tt>socket-server</tt></i>)</tt></dt><dd>Closes down the server socket.
    <a href="stream-dict.html#close" title="21.3.9. Function CLOSE">Just like streams</a>,
    <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a>s are closed at <a href="gc.html" title="Chapter 31. Overview of CLISP's Garbage Collection">garbage-collect</a>ion.  You should not rely on
    this however, because <a href="gc.html" title="Chapter 31. Overview of CLISP's Garbage Collection">garbage-collect</a>ion times are not deterministic.
 </dd><dt><a id="sose-hopo"></a><tt class="sexp">(<a href="socket.html#sose-hopo"><tt class="function">SOCKET:SOCKET-SERVER-HOST</tt></a> <i class="replaceable"><tt>socket-server</tt></i>)</tt><br /><tt class="sexp">(<a href="socket.html#sose-hopo"><tt class="function">SOCKET:SOCKET-SERVER-PORT</tt></a> <i class="replaceable"><tt>socket-server</tt></i>)</tt></dt><dd>Returns the host mask indicating which hosts can
    connect to this server and the port which was bound using <a href="socket.html#sose"><tt class="function">SOCKET:SOCKET-SERVER</tt></a>.
 </dd><dt><a id="so-wait"></a><tt class="sexp">(<a href="socket.html#so-wait"><tt class="function">SOCKET:SOCKET-WAIT</tt></a>
    <i class="replaceable"><tt>socket-server</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a> <a href="socket.html#timeout-opt">[<i class="replaceable"><tt>seconds</tt></i> [<i class="replaceable"><tt>microseconds</tt></i>]]</a>)</tt></dt><dd>Wait for a fixed time for a
    connection on the <i class="replaceable"><tt>socket-server</tt></i> (a <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a>).
    Without a timeout argument, <a href="socket.html#so-wait"><tt class="function">SOCKET:SOCKET-WAIT</tt></a> blocks indefinitely.
    When timeout is zero, poll.
    Returns <a href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><tt class="constant">T</tt></a> when a connection is available (i.e., <a href="socket.html#so-accept"><tt class="function">SOCKET:SOCKET-ACCEPT</tt></a> will
    not block) and <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> on timeout.</dd><dt><a id="so-accept"></a><tt class="sexp">(<a href="socket.html#so-accept"><tt class="function">SOCKET:SOCKET-ACCEPT</tt></a>
    <i class="replaceable"><tt>socket-server</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;KEY</tt></a> <a href="stream-dict.html#eltype"><tt class="constant">:ELEMENT-TYPE</tt></a> <a href="stream-dict.html#extfmt"><tt class="constant">:EXTERNAL-FORMAT</tt></a> <a href="stream-dict.html#buffered"><tt class="constant">:BUFFERED</tt></a>
    <a href="socket.html#timeout-k"><tt class="constant">:TIMEOUT</tt></a>)</tt></dt><dd>Creates the server-side two-way
    <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a> for the connection.
   Waits for an attempt to connect to the server for no more than
   <a href="socket.html#timeout-k"><tt class="constant">:TIMEOUT</tt></a> seconds (which may be a non-negative real number or a
   list <tt class="sexp">(sec usec)</tt> or a pair
   <tt class="sexp">(sec . usec)</tt>).
   <a href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><tt class="function">SIGNAL</tt></a>s an <a href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><tt class="classname">ERROR</tt></a> if no connection is made in that time.
  </dd><dt><a id="so-connect"></a><tt class="sexp">(<a href="socket.html#so-connect"><tt class="function">SOCKET:SOCKET-CONNECT</tt></a>
    <i class="replaceable"><tt>port</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a> [<i class="replaceable"><tt>host</tt></i>] <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;KEY</tt></a>
    <a href="stream-dict.html#eltype"><tt class="constant">:ELEMENT-TYPE</tt></a> <a href="stream-dict.html#extfmt"><tt class="constant">:EXTERNAL-FORMAT</tt></a> <a href="stream-dict.html#buffered"><tt class="constant">:BUFFERED</tt></a> <a href="socket.html#timeout-k"><tt class="constant">:TIMEOUT</tt></a>)</tt></dt><dd>Attempts to create a client-side two-way
   <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>.  Blocks until the server accepts the connection, for
   no more than <a href="socket.html#timeout-k"><tt class="constant">:TIMEOUT</tt></a> seconds.  If it is 0, returns immediately
   and (probably) blocks on the next i/o operation (you can use
   <a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a> to check whether it will actually block).
  </dd><dt><a id="so-status"></a><tt class="sexp">(<a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a>
                 <i class="replaceable"><tt>socket-stream-or-list</tt></i>
                 <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a> <a href="socket.html#timeout-opt">[<i class="replaceable"><tt>seconds</tt></i> [<i class="replaceable"><tt>microseconds</tt></i>]]</a>)</tt></dt><dd><p>Checks whether it is possible to read from or write
   to a <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a> or whether a connection is available on a
   <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a> without blocking.</p><p>For the cognoscenti: this is the interface to <a href="http://www.opengroup.org/onlinepubs/007904975/functions/select.html" target="_top"><tt class="function">select</tt></a>, so
   it will work for any <a href="http://clisp.cons.org" target="_top"><span><b class="command">CLISP</b></span></a> <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> which is based on a
   <a href="http://www.opengroup.org/onlinepubs/007904975/basedefs/xbd_chap03.html#tag_03_165" target="_top">file descriptor</a>, e.g., <a href="stream-dict.html#open" title="21.3.8. Function  OPEN">file</a>/<a href="shell.html#pipe" title="30.8.2. Pipes">pipe</a>/<a href="socket.html" title="30.5. Extensions-2.5. Socket Streams">socket</a> and <a href="terminal.html" title="21.2. Terminal interaction."><tt class="varname">EXT:*KEYBOARD-INPUT*</tt></a>.</p><p>This is similar to
    <a href="http://www.lisp.org/HyperSpec/Body/fun_listen.html" target="_top"><tt class="function">LISTEN</tt></a>, which checks only one <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> and only for input, and
    <a href="socket.html#so-wait"><tt class="function">SOCKET:SOCKET-WAIT</tt></a>, which works only with <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a>s.</p><p>We define “<span class="quote">status</span>” for a <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a> or a
    <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a> to be <tt class="constant">:ERROR</tt> if any i/o operation will cause an
    error.</p><p>Additionally, for a <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a>, we define
    “<span class="quote">status</span>” to be <a href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><tt class="constant">T</tt></a> if a connection is available, i.e.,
    is <a href="socket.html#so-accept"><tt class="function">SOCKET:SOCKET-ACCEPT</tt></a> will not block, and <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> otherwise.</p><p>Additionally, for a <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>, we define
    “<span class="quote">status</span>” in the given <i class="replaceable"><tt>direction</tt></i> (one of <tt class="constant">:INPUT</tt>,
    <tt class="constant">:OUTPUT</tt>, and <tt class="constant">:IO</tt>) to be
    </p><div class="variablelist"><a id="so-status-values"></a><p class="title"><b>Possible status values for various directions:</b></p><dl><dt><tt class="constant">:INPUT</tt> status:</dt><dd><div class="variablelist"><dl><dt><a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a></dt><dd>reading will block
        </dd><dt><tt class="constant">:INPUT</tt></dt><dd>some input is available
        </dd><dt><tt class="constant">:EOF</tt></dt><dd>the stream has reached its end
       </dd></dl></div></dd><dt><tt class="constant">:OUTPUT</tt> status:</dt><dd><div class="variablelist"><dl><dt><a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a></dt><dd>writing will block
        </dd><dt><tt class="constant">:OUTPUT</tt></dt><dd>output to the stream will not block
       </dd></dl></div></dd><dt><tt class="constant">:IO</tt> status:</dt><dd><div class="informaltable"><a id="so-status-i-o"></a><table border="1"><colgroup><col align="center" /><col align="center" /><col align="center" /><col align="center" /></colgroup><thead><tr><th rowspan="2" align="center" valign="bottom">output status</th><th colspan="3" align="center">input status</th></tr><tr><th align="center"><a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a></th><th align="center"><tt class="constant">:INPUT</tt></th><th align="center"><tt class="constant">:EOF</tt></th></tr></thead><tbody><tr><td align="center"><a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a></td><td align="center"><a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a></td><td align="center"><tt class="constant">:INPUT</tt></td><td align="center"><tt class="constant">:EOF</tt></td></tr><tr><td align="center"><tt class="constant">:OUTPUT</tt></td><td align="center"><tt class="constant">:OUTPUT</tt></td><td align="center"><tt class="constant">:IO</tt></td><td align="center"><tt class="constant">:APPEND</tt></td></tr></tbody></table></div></dd></dl></div><div class="variablelist"><p class="title"><b>Possible values of
     <i class="replaceable"><tt>socket-stream-or-list</tt></i>:</b></p><dl><dt><a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a> or <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-SERVER</tt></a></dt><dd>Returns the appropriate status, as defined
       above (<tt class="constant">:IO</tt> status for <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>)
    </dd><dt><tt class="sexp">(<a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>
       . <i class="replaceable"><tt>direction</tt></i>)</tt></dt><dd>Return the status in the specified direction
    </dd><dt>a list of the above</dt><dd>Return a list of values, one for each element of the
       argument list (a la <a href="http://www.lisp.org/HyperSpec/Body/fun_mapccm_ma_istcm_mapcon.html" target="_top"><tt class="function">MAPCAR</tt></a>)</dd></dl></div><p>If you want to avoid <a href="http://www.lisp.org/HyperSpec/Body/fun_cons.html" target="_top"><tt class="function">CONS</tt></a>ing up a <a href="http://www.lisp.org/HyperSpec/Body/glo_f.html#fresh" target="_top">fresh</a> list, you can
    make the elements of <i class="replaceable"><tt>socket-stream-or-list</tt></i>
    to be <tt class="sexp">(<i class="replaceable"><tt>socket-stream</tt></i> <i class="replaceable"><tt>direction</tt></i> .
     <i class="replaceable"><tt>x</tt></i>)</tt> or <tt class="sexp">(<i class="replaceable"><tt>socket-server</tt></i> . <i class="replaceable"><tt>x</tt></i>)</tt>.
    Then <a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a> will destructively modify its argument and replace
    <i class="replaceable"><tt>x</tt></i> or <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> with the status and return the modified list.
    You can pass this modified list to <a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a> again.</p><p>The optional arguments specify the timeout. <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> means
    wait forever, <tt class="literal">0</tt> means poll.</p><p>The second value returned is the number of objects with
    non-<a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> status, i.e., “<span class="quote">actionable</span>” objects.
    <a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a> returns either due to a timeout or when this number is
    positive, i.e., if the timeout was <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a> and <a href="socket.html#so-status"><tt class="function">SOCKET:SOCKET-STATUS</tt></a> did
    return, then the second value is positive.</p></dd><dt><a id="sost-hopo"></a><tt class="sexp">(<a href="socket.html#sost-hopo"><tt class="function">SOCKET:SOCKET-STREAM-HOST</tt></a> <i class="replaceable"><tt>socket-stream</tt></i>)</tt><br /><tt class="sexp">(<a href="socket.html#sost-hopo"><tt class="function">SOCKET:SOCKET-STREAM-PORT</tt></a> <i class="replaceable"><tt>socket-stream</tt></i>)</tt></dt><dd>These two functions return information about the
    <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>.</dd><dt><a id="service-port"></a><tt class="sexp">(<a href="socket.html#service-port"><tt class="function">SOCKET:SOCKET-SERVICE-PORT</tt></a>
                 <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;OPTIONAL</tt></a> <i class="replaceable"><tt>service-name</tt></i>
                 (<i class="replaceable"><tt>protocol</tt></i> "tcp"))</tt></dt><dd>A convenience function for looking up a port given
   the service name.  It returns the servent struct as <a href="http://www.lisp.org/HyperSpec/Body/glo_m.html#multiple_values" target="_top">multiple values</a>
   (name, list of aliases, port, protocol) for the given
   <i class="replaceable"><tt>service-name</tt></i> and
   <i class="replaceable"><tt>protocol</tt></i>, or all services as the list of
   <tt class="type">(<a href="http://www.lisp.org/HyperSpec/Body/typ_simple-vector.html" target="_top"><tt class="classname">SIMPLE-VECTOR</tt></a> 4)</tt>
   if <i class="replaceable"><tt>service-name</tt></i> is not given or is
   <tt class="constant">:DEFAULT</tt> or <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a>.</dd><dt><a id="sost-peer"></a><tt class="sexp">(<a href="socket.html#sost-peer"><tt class="function">SOCKET:SOCKET-STREAM-PEER</tt></a>
    <i class="replaceable"><tt>socket-stream</tt></i> [<i class="replaceable"><tt>do-not-resolve-p</tt></i>])</tt></dt><dd><p>Given a socket stream, this function returns the
   name of the host on the opposite side of the connection and its port
   number; the server-side can use this to see who connected.</p><p>When the optional second argument is non-<a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a>, the hostname
   resolution is disabled and just the IP address is returned, without
   the <span class="acronym">FQDN</span> (Fully Qualified Domain Name).
   </p></dd><dt><a id="sost-local"></a><tt class="sexp">(<a href="socket.html#sost-local"><tt class="function">SOCKET:SOCKET-STREAM-LOCAL</tt></a>
    <i class="replaceable"><tt>socket-stream</tt></i> [<i class="replaceable"><tt>do-not-resolve-p</tt></i>])</tt></dt><dd>The dual to <a href="socket.html#sost-peer"><tt class="function">SOCKET:SOCKET-STREAM-PEER</tt></a> - same information,
   host name and port number, but for the local host.
   The difference from <a href="socket.html#sost-hopo"><tt class="function">SOCKET:SOCKET-STREAM-HOST</tt></a> and <a href="socket.html#sost-hopo"><tt class="function">SOCKET:SOCKET-STREAM-PORT</tt></a> is that this function
   asks the OS (and thus returns the correct trusted values) while the
   other two are just accessors to the internal data structure, and
   basically return the arguments given to the function which created
   the <i class="replaceable"><tt>socket-stream</tt></i>.</dd><dt><a id="sost-shut"></a><tt class="sexp">(<a href="socket.html#sost-shut"><tt class="function">SOCKET:SOCKET-STREAM-SHUTDOWN</tt></a>
    <i class="replaceable"><tt>socket-stream</tt></i> <i class="replaceable"><tt>direction</tt></i>)</tt></dt><dd><p>Some Internet protocols, such as <a href="http://www.w3.org/Protocols/" target="_top"><span><b class="command">HTTP</b></span></a>, provide for
   closing the connection in one <i class="replaceable"><tt>direction</tt></i> using <a href="http://www.opengroup.org/onlinepubs/007904975/functions/shutdown.html" target="_top"><tt class="function">shutdown</tt></a>.
   This function provides an interface to this <a href="http://www.UNIX-systems.org/online.html" target="_top"><strong>UNIX</strong></a> system call.
   <i class="replaceable"><tt>direction</tt></i> should be <tt class="constant">:INPUT</tt> or <tt class="constant">:OUTPUT</tt>.
   Note that you should still call <a href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><tt class="function">CLOSE</tt></a> after you are done with your
   <i class="replaceable"><tt>socket-stream</tt></i>; this is best accomplished by using <a href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><tt class="function">WITH-OPEN-STREAM</tt></a>.</p><p>All <a href="socket.html" title="30.5. Extensions-2.5. Socket Streams"><tt class="classname">SOCKET:SOCKET-STREAM</tt></a>s are <a href="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional" target="_top">bidirectional</a> <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a>s (i.e., both <a href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><tt class="function">INPUT-STREAM-P</tt></a>
   and <a href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><tt class="function">OUTPUT-STREAM-P</tt></a> return <a href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><tt class="constant">T</tt></a> for them).
   <a href="socket.html#sost-shut"><tt class="function">SOCKET:SOCKET-STREAM-SHUTDOWN</tt></a> <span class="emphasis"><em>breaks</em></span> this and turns its argument
   stream into an <a href="http://www.lisp.org/HyperSpec/Body/glo_i.html#input" target="_top">input</a> <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> (if <i class="replaceable"><tt>direction</tt></i> is <tt class="constant">:OUTPUT</tt>) or <a href="http://www.lisp.org/HyperSpec/Body/glo_o.html#output" target="_top">output</a> <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> (if
   <i class="replaceable"><tt>direction</tt></i> is <tt class="constant">:INPUT</tt>).
    Thus, the following important invariant is preserved: whenever
   </p><div class="itemizedlist"><ul type="disc"><li>a <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> is open
    (i.e., <a href="http://www.lisp.org/HyperSpec/Body/fun_open-stream-p.html" target="_top"><tt class="function">OPEN-STREAM-P</tt></a> returns <a href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><tt class="constant">T</tt></a>) and</li><li>a <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> is an <a href="http://www.lisp.org/HyperSpec/Body/glo_i.html#input" target="_top">input</a> <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> (i.e., <a href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><tt class="function">INPUT-STREAM-P</tt></a>
     returns <a href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><tt class="constant">T</tt></a>)</li></ul></div><p>
   the <a href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><tt class="classname">STREAM</tt></a> can be read from (e.g., with <a href="http://www.lisp.org/HyperSpec/Body/fun_read-char.html" target="_top"><tt class="function">READ-CHAR</tt></a> or <a href="http://www.lisp.org/HyperSpec/Body/fun_read-byte.html" target="_top"><tt class="function">READ-BYTE</tt></a>).
 </p></dd><dt><a id="so-opt"></a><tt class="sexp">(<a href="socket.html#so-opt"><tt class="function">SOCKET:SOCKET-OPTIONS</tt></a>
    <i class="replaceable"><tt>socket-server</tt></i> <a href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><tt class="literal">&amp;REST</tt></a> {<i class="replaceable"><tt>option</tt></i>}*)</tt></dt><dd>Query and, optionally, set socket options using
   <a href="http://www.opengroup.org/onlinepubs/007904975/functions/getsockopt.html" target="_top"><tt class="function">getsockopt</tt></a> and <a href="http://www.opengroup.org/onlinepubs/007904975/functions/setsockopt.html" target="_top"><tt class="function">setsockopt</tt></a>.
   An <i class="replaceable"><tt>option</tt></i> is a keyword, optionally followed by the new value.
   When the new value is not supplied, <a href="http://www.opengroup.org/onlinepubs/007904975/functions/setsockopt.html" target="_top"><tt class="function">setsockopt</tt></a> is not called.
   For each option the old (or current, if new value was not supplied)
   value is returned. E.g., <tt class="sexp">(<a href="socket.html#so-opt"><tt class="function">SOCKET:SOCKET-OPTIONS</tt></a> <i class="replaceable"><tt>socket-server</tt></i>
   :SO-LINGER 1 :SO-RCVLOWAT)</tt> returns 2 values: <a href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><tt class="constant">NIL</tt></a>, the old
   value of the <tt class="constant">:SO-LINGER</tt> option, and 1, the
   current value of the <tt class="constant">:SO-RCVLOWAT</tt> option.
  </dd></dl></div>
<!--#endif-->
</div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="affi.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="platform.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="quickstart.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">30.4. Extensions-2.4. The Amiga Foreign Function Call Facility </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 30.6. Extensions-2.6. Quickstarting delivery with <span><b class="command">CLISP</b></span></td></tr></table></div><div class="custom-footer"><hr width="100%" /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://www.gnu.org"><img src="http://www.gnu.org/graphics/gnubanner.jpg" width="468" height="60" alt="[Come and see what GNU creates for YOU]" /></a></td><td align="right"><a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=1355&amp;amp;type=2" width="125" height="37" alt="[SourceForge]" /></a></td></tr></table></div></body></html>
